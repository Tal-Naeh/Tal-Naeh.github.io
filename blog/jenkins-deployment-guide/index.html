<!DOCTYPE html><html lang="en" data-astro-cid-bvzihdzo> <head><!-- Google tag (gtag.js) --><script async src="https://www.googletagmanager.com/gtag/js?id=G-ECGK9Y42TF"></script><script>window.dataLayer = window.dataLayer || [];function gtag(){dataLayer.push(arguments);}gtag('js', new Date());gtag('config', 'G-ECGK9Y42TF');</script><!-- Global Metadata --><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><link rel="icon" type="image/svg+xml" href="/favicon.svg"><link rel="sitemap" href="/sitemap-index.xml"><link rel="alternate" type="application/rss+xml" title="DevOps Out Loud" href="https://tal-naeh.github.io/rss.xml"><!-- Font preloads --><link rel="preload" href="/fonts/atkinson-regular.woff" as="font" type="font/woff" crossorigin><link rel="preload" href="/fonts/atkinson-bold.woff" as="font" type="font/woff" crossorigin><!-- Canonical URL --><link rel="canonical" href="https://tal-naeh.github.io/blog/jenkins-deployment-guide/"><!-- Primary Meta Tags --><title>Where Should You Actually Run Jenkins?</title><meta name="title" content="Where Should You Actually Run Jenkins?"><meta name="description" content="Docker container, Kubernetes, or bare metal? Here's what I've learned from deploying Jenkins in every way possible—and when each approach makes sense."><!-- Open Graph / Facebook --><meta property="og:type" content="website"><meta property="og:url" content="https://tal-naeh.github.io/blog/jenkins-deployment-guide/"><meta property="og:title" content="Where Should You Actually Run Jenkins?"><meta property="og:description" content="Docker container, Kubernetes, or bare metal? Here's what I've learned from deploying Jenkins in every way possible—and when each approach makes sense."><meta property="og:image" content="https://www.jenkins.io/images/logos/jenkins/jenkins.png"><!-- Twitter --><meta property="twitter:card" content="summary_large_image"><meta property="twitter:url" content="https://tal-naeh.github.io/blog/jenkins-deployment-guide/"><meta property="twitter:title" content="Where Should You Actually Run Jenkins?"><meta property="twitter:description" content="Docker container, Kubernetes, or bare metal? Here's what I've learned from deploying Jenkins in every way possible—and when each approach makes sense."><meta property="twitter:image" content="https://www.jenkins.io/images/logos/jenkins/jenkins.png"><style>:root{--accent: #2337ff;--accent-dark: #000d8a;--black: 15, 18, 25;--gray: 96, 115, 159;--gray-light: 229, 233, 240;--gray-dark: 34, 41, 57;--gray-gradient: rgba(var(--gray-light), 50%), #fff;--box-shadow: 0 2px 6px rgba(var(--gray), 25%), 0 8px 24px rgba(var(--gray), 33%), 0 16px 32px rgba(var(--gray), 33%)}@font-face{font-family:Atkinson;src:url(/fonts/atkinson-regular.woff) format("woff");font-weight:400;font-style:normal;font-display:swap}@font-face{font-family:Atkinson;src:url(/fonts/atkinson-bold.woff) format("woff");font-weight:700;font-style:normal;font-display:swap}body{font-family:Atkinson,sans-serif;margin:0;padding:0;text-align:left;background:linear-gradient(var(--gray-gradient)) no-repeat;background-size:100% 600px;word-wrap:break-word;overflow-wrap:break-word;color:rgb(var(--gray-dark));font-size:20px;line-height:1.7}main{width:720px;max-width:calc(100% - 2em);margin:auto;padding:3em 1em}h1,h2,h3,h4,h5,h6{margin:0 0 .5rem;color:rgb(var(--black));line-height:1.2}h1{font-size:3.052em}h2{font-size:2.441em}h3{font-size:1.953em}h4{font-size:1.563em}h5{font-size:1.25em}strong,b{font-weight:700}a,a:hover{color:var(--accent)}p{margin-bottom:1em}.prose p{margin-bottom:2em}textarea{width:100%;font-size:16px}input{font-size:16px}table{width:100%}img{max-width:100%;height:auto;border-radius:8px}code{padding:2px 5px;background-color:rgb(var(--gray-light));border-radius:2px}pre{padding:1.5em;border-radius:8px}pre>code{all:unset}blockquote{border-left:4px solid var(--accent);padding:0 0 0 20px;margin:0;font-size:1.333em}hr{border:none;border-top:1px solid rgb(var(--gray-light))}@media (max-width: 720px){body{font-size:18px}main{padding:1em}}.sr-only{border:0;padding:0;margin:0;position:absolute!important;height:1px;width:1px;overflow:hidden;clip:rect(1px 1px 1px 1px);clip:rect(1px,1px,1px,1px);clip-path:inset(50%);white-space:nowrap}a[data-astro-cid-eimmu3lg]{display:inline-block;text-decoration:none}a[data-astro-cid-eimmu3lg].active{font-weight:bolder;text-decoration:underline}header[data-astro-cid-3ef6ksr2]{margin:0;padding:0 1em;background:#fff;box-shadow:0 2px 8px rgba(var(--black),5%)}h2[data-astro-cid-3ef6ksr2]{margin:0;font-size:1em}h2[data-astro-cid-3ef6ksr2] a[data-astro-cid-3ef6ksr2],h2[data-astro-cid-3ef6ksr2] a[data-astro-cid-3ef6ksr2].active{text-decoration:none}nav[data-astro-cid-3ef6ksr2]{display:flex;align-items:center;justify-content:space-between}nav[data-astro-cid-3ef6ksr2] a[data-astro-cid-3ef6ksr2]{padding:1em .5em;color:var(--black);border-bottom:4px solid transparent;text-decoration:none}nav[data-astro-cid-3ef6ksr2] a[data-astro-cid-3ef6ksr2].active{text-decoration:none;border-bottom-color:var(--accent)}.social-links[data-astro-cid-3ef6ksr2],.social-links[data-astro-cid-3ef6ksr2] a[data-astro-cid-3ef6ksr2]{display:flex}@media (max-width: 720px){.social-links[data-astro-cid-3ef6ksr2]{display:none}}footer[data-astro-cid-sz7xmlte]{padding:2em 1em 6em;background:linear-gradient(var(--gray-gradient)) no-repeat;color:rgb(var(--gray));text-align:center}.social-links[data-astro-cid-sz7xmlte]{display:flex;justify-content:center;gap:1em;margin-top:1em}.social-links[data-astro-cid-sz7xmlte] a[data-astro-cid-sz7xmlte]{text-decoration:none;color:rgb(var(--gray))}.social-links[data-astro-cid-sz7xmlte] a[data-astro-cid-sz7xmlte]:hover{color:rgb(var(--gray-dark))}
main[data-astro-cid-bvzihdzo]{width:calc(100% - 2em);max-width:100%;margin:0}.hero-image[data-astro-cid-bvzihdzo]{width:100%}.hero-image[data-astro-cid-bvzihdzo] img[data-astro-cid-bvzihdzo]{display:block;margin:0 auto;border-radius:12px;box-shadow:var(--box-shadow)}.prose[data-astro-cid-bvzihdzo]{width:720px;max-width:calc(100% - 2em);margin:auto;padding:1em;color:rgb(var(--gray-dark))}.title[data-astro-cid-bvzihdzo]{margin-bottom:1em;padding:1em 0;text-align:center;line-height:1}.title[data-astro-cid-bvzihdzo] h1[data-astro-cid-bvzihdzo]{margin:0 0 .5em}.date[data-astro-cid-bvzihdzo]{margin-bottom:.5em;color:rgb(var(--gray))}.last-updated-on[data-astro-cid-bvzihdzo]{font-style:italic}
</style></head> <body data-astro-cid-bvzihdzo> <header data-astro-cid-3ef6ksr2> <nav data-astro-cid-3ef6ksr2> <h2 data-astro-cid-3ef6ksr2><a href="/" data-astro-cid-3ef6ksr2>DevOps Out Loud</a></h2> <div class="internal-links" data-astro-cid-3ef6ksr2> <a href="/" data-astro-cid-3ef6ksr2="true" data-astro-cid-eimmu3lg> Home </a>  <a href="/blog" class="active" data-astro-cid-3ef6ksr2="true" data-astro-cid-eimmu3lg> Blog </a>  <a href="/about" data-astro-cid-3ef6ksr2="true" data-astro-cid-eimmu3lg> About </a>  </div> <div class="social-links" data-astro-cid-3ef6ksr2> <a href="https://linkedin.com/in/tal-naeh" target="_blank" data-astro-cid-3ef6ksr2> <span class="sr-only" data-astro-cid-3ef6ksr2>Follow on LinkedIn</span> <svg viewBox="0 0 16 16" aria-hidden="true" width="32" height="32" data-astro-cid-3ef6ksr2><path fill="currentColor" d="M0 1.146C0 .513.526 0 1.175 0h13.65C15.474 0 16 .513 16 1.146v13.708c0 .633-.526 1.146-1.175 1.146H1.175C.526 16 0 15.487 0 14.854V1.146zm4.943 12.248V6.169H2.542v7.225h2.401zm-1.2-8.212c.837 0 1.358-.554 1.358-1.248-.015-.709-.52-1.248-1.342-1.248-.822 0-1.359.54-1.359 1.248 0 .694.521 1.248 1.327 1.248h.016zm4.908 8.212V9.359c0-.216.016-.432.08-.586.173-.431.568-.878 1.232-.878.869 0 1.216.662 1.216 1.634v3.865h2.401V9.25c0-2.22-1.184-3.252-2.764-3.252-1.274 0-1.845.7-2.165 1.193v.025h-.016a5.54 5.54 0 0 1 .016-.025V6.169h-2.4c.03.678 0 7.225 0 7.225h2.4z" data-astro-cid-3ef6ksr2></path></svg> </a> <a href="https://github.com/Tal-Naeh" target="_blank" data-astro-cid-3ef6ksr2> <span class="sr-only" data-astro-cid-3ef6ksr2>Visit my GitHub</span> <svg viewBox="0 0 16 16" aria-hidden="true" width="32" height="32" data-astro-cid-3ef6ksr2><path fill="currentColor" d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.012 8.012 0 0 0 16 8c0-4.42-3.58-8-8-8z" data-astro-cid-3ef6ksr2></path></svg> </a> </div> </nav> </header>  <main data-astro-cid-bvzihdzo> <article data-astro-cid-bvzihdzo> <div class="hero-image" data-astro-cid-bvzihdzo> <img src="https://www.jenkins.io/images/logos/jenkins/jenkins.png" alt="Jenkins Logo" style="max-width: 400px; height: auto;" data-astro-cid-bvzihdzo> </div> <div class="prose" data-astro-cid-bvzihdzo> <div class="title" data-astro-cid-bvzihdzo> <div class="date" data-astro-cid-bvzihdzo> <time datetime="2025-10-03T00:00:00.000Z"> Oct 3, 2025 </time> <div class="last-updated-on" data-astro-cid-bvzihdzo>
Last updated on <time datetime="2025-10-03T00:00:00.000Z"> Oct 3, 2025 </time> </div> </div> <h1 data-astro-cid-bvzihdzo>Where Should You Actually Run Jenkins?</h1> <hr data-astro-cid-bvzihdzo> </div>

<p><strong>I've run Jenkins on bare metal, in Docker containers, on Kubernetes, and even on a Raspberry Pi (don't ask). Here's what actually works, what doesn't, and when to use each approach.</strong></p>

<p>The "where should I run Jenkins?" question comes up in every architecture discussion. The answer isn't simple because Jenkins is weird—it's stateful, it spawns jobs that need their own resources, and it has plugins that expect filesystem access. Get the deployment wrong, and you'll spend more time fighting Jenkins than actually using it.</p>

<blockquote>
<p><strong>Bottom line:</strong> Start with Docker Compose on a VM for small teams. Move to Kubernetes only when you need high availability or dynamic scaling. Bare metal is fine if you're okay with manual maintenance. Avoid running Jenkins controller pods in K8s unless you really need HA—the complexity usually isn't worth it.</p>
</blockquote>

<hr>

<h2 id="the-jenkins-deployment-problem">The Jenkins Deployment Problem</h2>

<p>Jenkins was born in 2011 as Hudson. It predates Docker (2013), Kubernetes (2014), and modern CI/CD patterns. This means:</p>

<ul>
<li><strong>It's stateful as hell:</strong> Jobs, build history, plugins, credentials—all stored on disk</li>
<li><strong>It wants to manage agents:</strong> Jenkins assumes it can SSH into machines or spin up new ones</li>
<li><strong>Plugin chaos:</strong> 1,800+ plugins with varying quality and assumptions about the runtime environment</li>
<li><strong>Java heap management:</strong> You need to tune JVM settings for your workload</li>
</ul>

<p>This isn't a criticism—Jenkins works great. But these characteristics mean deployment strategy matters more than with stateless applications.</p>

<hr>

<h2 id="option-1-docker-container-on-a-vm">Option 1: Docker Container on a VM</h2>

<h3 id="docker-the-setup">The Setup</h3>

<p>Run Jenkins as a Docker container with a bind-mounted volume for persistence:</p>

<pre><code class="language-yaml"># docker-compose.yml
version: '3.8'
services:
  jenkins:
    image: jenkins/jenkins:lts
    container_name: jenkins
    restart: unless-stopped
    ports:
      - "8080:8080"
      - "50000:50000"
    volumes:
      - jenkins_home:/var/jenkins_home
      - /var/run/docker.sock:/var/run/docker.sock  # For Docker-in-Docker
    environment:
      - JAVA_OPTS=-Xmx2048m -Xms1024m

volumes:
  jenkins_home:</code></pre>

<h3 id="docker-when-this-works">When This Works</h3>

<p>This is my go-to for:</p>

<ul>
<li><strong>Small to medium teams (1-50 developers):</strong> Simple, predictable, easy to troubleshoot</li>
<li><strong>Single-server simplicity:</strong> Everything on one machine, no orchestration complexity</li>
<li><strong>Quick setup:</strong> Five minutes from zero to running Jenkins</li>
<li><strong>Easy backups:</strong> <code>docker-compose down</code>, copy the volume, done</li>
<li><strong>Plugin testing:</strong> Spin up a test Jenkins in seconds</li>
</ul>

<h3 id="docker-the-real-world-experience">The Real-World Experience</h3>

<p>I've run production Jenkins this way for a 30-person engineering team. It just works. Upgrades are <code>docker-compose pull && docker-compose up -d</code>. When disk fills up, you know exactly where to look. When something breaks, you're not debugging Kubernetes networking on top of Jenkins issues.</p>

<p>The only time this setup hurt us: the VM went down and everyone was blocked for 20 minutes while it restarted. For most teams, this is an acceptable trade-off compared to the complexity of HA setups.</p>

<h3 id="docker-watch-out-for">Watch Out For</h3>

<ul>
<li><strong>Docker-in-Docker:</strong> If your builds need Docker, you're mounting <code>/var/run/docker.sock</code>. This works but is a security risk—jobs can escape containers</li>
<li><strong>Resource limits:</strong> Set them in docker-compose or Jenkins will eat all your RAM</li>
<li><strong>Backup strategy:</strong> Automate volume backups or you'll lose everything</li>
<li><strong>No high availability:</strong> VM goes down = Jenkins is down</li>
</ul>

<hr>

<h2 id="option-2-bare-metal-vm">Option 2: Bare Metal / VM</h2>

<h3 id="baremetal-the-setup">The Setup</h3>

<p>Install Jenkins directly on a Linux VM:</p>

<pre><code class="language-bash"># Ubuntu/Debian
wget -q -O - https://pkg.jenkins.io/debian/jenkins.io.key | sudo apt-key add -
sudo sh -c 'echo deb http://pkg.jenkins.io/debian-stable binary/ > /etc/apt/sources.list.d/jenkins.list'
sudo apt update
sudo apt install jenkins

# Start Jenkins
sudo systemctl start jenkins
sudo systemctl enable jenkins</code></pre>

<h3 id="baremetal-when-this-works">When This Works</h3>

<ul>
<li><strong>You're already managing VMs:</strong> No Docker/K8s in your stack</li>
<li><strong>Compliance requirements:</strong> Some orgs don't allow containers</li>
<li><strong>Heavy plugin usage:</strong> Some ancient plugins assume filesystem paths that break in containers</li>
<li><strong>Maximum performance:</strong> No container overhead (though it's negligible)</li>
<li><strong>Legacy systems:</strong> Existing Jenkins that's been running for years</li>
</ul>

<h3 id="baremetal-the-honest-truth">The Honest Truth</h3>

<p>This is how we ran Jenkins from 2018-2020. It worked fine, but upgrades were a pain. You're managing Java versions, system packages, plugin conflicts, and dealing with "works on my machine" problems when troubleshooting.</p>

<p>The killer issue: reproducibility. When Jenkins breaks, you can't just spin up an identical copy to test fixes. You're SSH'd into prod, making changes, and hoping.</p>

<h3 id="baremetal-watch-out-for">Watch Out For</h3>

<ul>
<li><strong>Manual updates:</strong> You're responsible for OS patches, Java updates, Jenkins updates</li>
<li><strong>Difficult migrations:</strong> Moving to a new server means migrating plugins, jobs, configs manually</li>
<li><strong>No rollback:</strong> Update breaks something? Hope you have a snapshot</li>
<li><strong>Server drift:</strong> Over time, your Jenkins server becomes a unique snowflake</li>
</ul>

<hr>

<h2 id="option-3-kubernetes-controller-agents">Option 3: Kubernetes (Controller + Agents)</h2>

<h3 id="k8s-the-setup">The Setup</h3>

<p>Jenkins controller as a StatefulSet, agents as ephemeral pods:</p>

<pre><code class="language-yaml">apiVersion: apps/v1
kind: StatefulSet
metadata:
  name: jenkins
spec:
  serviceName: jenkins
  replicas: 1
  selector:
    matchLabels:
      app: jenkins
  template:
    metadata:
      labels:
        app: jenkins
    spec:
      containers:
      - name: jenkins
        image: jenkins/jenkins:lts
        ports:
        - containerPort: 8080
        - containerPort: 50000
        volumeMounts:
        - name: jenkins-home
          mountPath: /var/jenkins_home
        resources:
          requests:
            memory: "2Gi"
            cpu: "1000m"
          limits:
            memory: "4Gi"
            cpu: "2000m"
  volumeClaimTemplates:
  - metadata:
      name: jenkins-home
    spec:
      accessModes: [ "ReadWriteOnce" ]
      resources:
        requests:
          storage: 100Gi</code></pre>

<h3 id="k8s-when-this-works">When This Works</h3>

<ul>
<li><strong>You're already on Kubernetes:</strong> Everything else runs there, why not Jenkins?</li>
<li><strong>Dynamic agent scaling:</strong> Spin up pods per build, destroy when done</li>
<li><strong>Resource isolation:</strong> Each build gets its own container with CPU/memory limits</li>
<li><strong>Multi-tenant builds:</strong> Different teams need isolated build environments</li>
<li><strong>Cloud-native stack:</strong> Your entire infrastructure is K8s-based</li>
</ul>

<h3 id="k8s-why-i-actually-recommend-this">Why I Actually Recommend This (Sometimes)</h3>

<p>We moved to this model when our build queue started backing up. With Kubernetes agents, we can run 20 builds simultaneously, each in its own pod with exactly the resources it needs. When builds finish, pods disappear. No idle VMs sitting around.</p>

<p>The Jenkins Kubernetes plugin works surprisingly well. Configure it once, and Jenkins automatically provisions pods for each build:</p>

<pre><code class="language-groovy">// Jenkinsfile
pipeline {
    agent {
        kubernetes {
            yaml '''
apiVersion: v1
kind: Pod
spec:
  containers:
  - name: maven
    image: maven:3.8-jdk-11
    command: ['sleep']
    args: ['infinity']
  - name: docker
    image: docker:latest
    command: ['sleep']
    args: ['infinity']
'''
        }
    }
    stages {
        stage('Build') {
            steps {
                container('maven') {
                    sh 'mvn clean package'
                }
            }
        }
    }
}</code></pre>

<h3 id="k8s-watch-out-for">Watch Out For</h3>

<ul>
<li><strong>Complexity explosion:</strong> Now you're debugging Jenkins AND Kubernetes</li>
<li><strong>Persistent volume drama:</strong> Jenkins needs ReadWriteOnce storage, which limits where pods can run</li>
<li><strong>Slow agent startup:</strong> Pulling images for each build adds 30-60 seconds</li>
<li><strong>Plugin compatibility:</strong> Some plugins don't play nice with K8s agents</li>
<li><strong>Network policies:</strong> Jenkins needs to reach agents, which can be tricky with strict network policies</li>
</ul>

<hr>

<h2 id="option-4-kubernetes-ha-jenkins">Option 4: Kubernetes HA Jenkins (Controller Redundancy)</h2>

<h3 id="k8s-ha-the-reality-check">The Reality Check</h3>

<p>Running multiple Jenkins controllers for high availability is <em>technically</em> possible but honestly, don't do this unless you have a very specific need.</p>

<p>The problem: Jenkins wasn't designed for active-active clustering. You can set up active-passive with shared storage, but then you're dealing with:</p>

<ul>
<li>ReadWriteMany storage (expensive, slow, complex)</li>
<li>Session affinity for web UI</li>
<li>Database-backed job storage (with CloudBees plugins)</li>
<li>Complex failover logic</li>
</ul>

<h3 id="k8s-ha-when-this-actually-makes-sense">When This Actually Makes Sense</h3>

<ul>
<li><strong>You're paying for CloudBees:</strong> Their enterprise version handles this better</li>
<li><strong>Downtime costs serious money:</strong> Every minute of Jenkins downtime costs thousands of dollars</li>
<li><strong>You have a dedicated platform team:</strong> Someone's full-time job is keeping Jenkins running</li>
</ul>

<p>For 99% of teams: just accept that Jenkins will be down during upgrades. It's not worth the complexity.</p>

<hr>

<h2 id="the-agent-strategy-matters-more">The Agent Strategy Matters More Than Controller</h2>

<p>Here's something nobody talks about: where you run the Jenkins <em>controller</em> matters way less than how you run <em>agents</em>.</p>

<h3 id="agent-static-agents-the-old-way">Static Agents (The Old Way)</h3>

<pre><code>Jenkins Controller → SSH → Permanent Agent VMs</code></pre>

<p><strong>Pros:</strong> Simple, predictable, works with every plugin<br>
<strong>Cons:</strong> Wasted resources, configuration drift, manual scaling</p>

<p>We had 10 permanent agent VMs. On average, 7 were idle. That's thousands of dollars a month on idle VMs. Plus, every time we needed to update Docker or dependencies, we had to manually SSH into 10 machines.</p>

<h3 id="agent-dynamic-agents-the-new-way">Dynamic Agents (The New Way)</h3>

<pre><code>Jenkins Controller → Kubernetes/Docker → Ephemeral Agents</code></pre>

<p><strong>Pros:</strong> Scales infinitely, no configuration drift, cost-efficient<br>
<strong>Cons:</strong> Slower startup, requires good image management</p>

<p>Now we run 0 permanent agents. Every build gets a fresh pod that's destroyed when done. Our AWS bill dropped 40% and builds are more reliable because there's no state lingering between builds.</p>

<h3 id="agent-my-recommendation">My Recommendation</h3>

<p>Regardless of where you run the Jenkins controller, use dynamic agents. Even if Jenkins itself runs in Docker Compose, configure it to spin up Docker containers as agents.</p>

<hr>

<h2 id="the-decision-matrix">The Decision Matrix</h2>

<h3 id="matrix-you-should-use-docker-compose-if">You Should Use Docker Compose If:</h3>

<ul>
<li>Team size: 1-50 developers</li>
<li>You have one VM to dedicate</li>
<li>Downtime of 10-30 minutes is acceptable</li>
<li>You want simple backups and upgrades</li>
<li>You're not on Kubernetes for other things</li>
</ul>

<h3 id="matrix-you-should-use-kubernetes-if">You Should Use Kubernetes If:</h3>

<ul>
<li>Team size: 50+ developers</li>
<li>You're already running K8s</li>
<li>You need dynamic build agent scaling</li>
<li>You run many concurrent builds</li>
<li>You want resource isolation between builds</li>
</ul>

<h3 id="matrix-you-should-use-bare-metal-if">You Should Use Bare Metal If:</h3>

<ul>
<li>You already have a VM and don't want to change</li>
<li>Compliance requires it</li>
<li>You have plugins that don't work in containers</li>
<li>You're very comfortable with traditional Linux administration</li>
</ul>

<h3 id="matrix-you-should-skip-ha-jenkins-unless">You Should Skip HA Jenkins Unless:</h3>

<ul>
<li>Downtime literally costs $10k+ per hour</li>
<li>You're paying for CloudBees Enterprise</li>
<li>You have a dedicated platform team</li>
</ul>

<hr>

<h2 id="what-we-actually-run">What We Actually Run</h2>

<p>After trying everything, here's our current setup:</p>

<ul>
<li><strong>Jenkins controller:</strong> Docker Compose on a dedicated EC2 instance (t3.xlarge)</li>
<li><strong>Jenkins agents:</strong> Kubernetes pods that spin up per-build</li>
<li><strong>Backup:</strong> Daily snapshots of the jenkins_home volume to S3</li>
<li><strong>Monitoring:</strong> Prometheus exports + PagerDuty for alerts</li>
</ul>

<p>Why not run the controller on Kubernetes? Because the complexity wasn't worth it. We get:</p>

<ul>
<li>Simple troubleshooting (just SSH to one machine)</li>
<li>Fast startup (no image pulling for controller)</li>
<li>Predictable performance (dedicated resources)</li>
<li>Easy rollback (docker-compose down, restore volume, up)</li>
</ul>

<p>But we get dynamic agent scaling and resource isolation by using K8s agents. Best of both worlds.</p>

<hr>

<h2 id="the-mistakes-ive-made">The Mistakes I've Made</h2>

<h3 id="mistakes-mistake-1-jenkins-controller-in-k8s-too-early">Mistake 1: Jenkins Controller in K8s Too Early</h3>

<p>We moved to K8s-based Jenkins when we had 15 developers. The operational overhead of managing StatefulSets, PVCs, and debugging pod issues wasn't worth it. Went back to Docker Compose and didn't regret it.</p>

<h3 id="mistakes-mistake-2-not-planning-for-disk-growth">Mistake 2: Not Planning for Disk Growth</h3>

<p>Jenkins home directory grows fast—build artifacts, logs, workspaces. We started with a 50GB volume and filled it in 3 months. Now we use 200GB and have alerts at 80% usage.</p>

<h3 id="mistakes-mistake-3-mounting-docker-sock-without-thinking">Mistake 3: Mounting Docker Sock Without Thinking</h3>

<p>Mounting <code>/var/run/docker.sock</code> into Jenkins lets jobs control Docker, but it's basically root access to the host. One malicious Jenkinsfile can take over your entire server. We now use dedicated build agents with Docker-in-Docker instead.</p>

<h3 id="mistakes-mistake-4-not-using-configuration-as-code">Mistake 4: Not Using Configuration as Code</h3>

<p>We configured Jenkins via the UI for years. Every time we rebuilt it, we had to remember dozens of settings. Now we use the <a href="https://plugins.jenkins.io/configuration-as-code/">Configuration as Code plugin</a> and Jenkins configs live in Git. Game changer.</p>

<hr>

<h2 id="quick-start-my-recommended-setup">Quick Start: My Recommended Setup</h2>

<p>If you're starting fresh today, here's what I'd do:</p>

<h3 id="quick-start-step-1-docker-compose-setup">Step 1: Docker Compose Setup</h3>

<pre><code class="language-yaml">version: '3.8'
services:
  jenkins:
    image: jenkins/jenkins:lts
    container_name: jenkins
    restart: unless-stopped
    user: root  # Needed for Docker socket access
    ports:
      - "8080:8080"
      - "50000:50000"
    volumes:
      - jenkins_home:/var/jenkins_home
      - /var/run/docker.sock:/var/run/docker.sock
    environment:
      - JAVA_OPTS=-Xmx2048m -Xms1024m -Djenkins.install.runSetupWizard=false
      - CASC_JENKINS_CONFIG=/var/jenkins_home/casc.yaml

volumes:
  jenkins_home:</code></pre>

<h3 id="quick-start-step-2-configuration-as-code">Step 2: Configuration as Code</h3>

<pre><code class="language-yaml"># casc.yaml
jenkins:
  systemMessage: "Jenkins configured automatically"
  numExecutors: 0  # Controller doesn't run builds
  securityRealm:
    local:
      allowsSignup: false
      users:
        - id: admin
          password: ${JENKINS_ADMIN_PASSWORD}
  authorizationStrategy:
    globalMatrix:
      permissions:
        - "Overall/Administer:admin"
        - "Overall/Read:authenticated"

  clouds:
    - docker:
        name: "docker"
        dockerApi:
          dockerHost:
            uri: "unix:///var/run/docker.sock"
        templates:
          - labelString: "docker-agent"
            dockerTemplateBase:
              image: "jenkins/inbound-agent:latest"
              volumes:
                - type: "bind"
                  source: "/var/run/docker.sock"
                  target: "/var/run/docker.sock"
            remoteFs: "/home/jenkins/agent"
            connector:
              attach:
                user: "root"
            instanceCapStr: "10"</code></pre>

<h3 id="quick-start-step-3-launch-it">Step 3: Launch It</h3>

<pre><code class="language-bash">export JENKINS_ADMIN_PASSWORD=changeme
docker-compose up -d</code></pre>

<p>That's it. You've got Jenkins with dynamic Docker agents in about 5 minutes.</p>

<hr>

<h2 id="when-to-migrate-to-kubernetes">When to Migrate to Kubernetes</h2>

<p>You'll know it's time when:</p>

<ul>
<li>You're running 50+ builds per day and docker-compose agents can't keep up</li>
<li>You need resource quotas per team/project</li>
<li>You're already running everything else on K8s and Jenkins is the oddball</li>
<li>You need multiple agent types with different tooling (Java, Node, Python, etc.)</li>
<li>Your team has K8s expertise and troubleshooting won't be a nightmare</li>
</ul>

<p>But even then, consider keeping the controller on Docker Compose and only moving agents to K8s.</p>

<hr>

<h2 id="final-thoughts">Final Thoughts</h2>

<p>The best Jenkins deployment is the one you can actually maintain. Docker Compose is underrated—it's simple, reliable, and handles 90% of use cases. Kubernetes makes sense for dynamic agents, but running the controller there adds complexity you might not need.</p>

<p>Don't overthink it. Start simple, measure actual pain points, and add complexity only when it solves a real problem. Jenkins downtime for upgrades once a month is not a real problem for most teams. Spending a week debugging PVC issues in Kubernetes is.</p>

<blockquote>
<p><strong>TL;DR:</strong> Docker Compose for the controller, dynamic agents (Docker or K8s) for builds. Kubernetes for everything only if you're already deep in the K8s ecosystem and have the expertise. Bare metal if you hate yourself or have strict compliance requirements. Skip HA unless downtime actually costs you serious money.</p>
</blockquote>

</div> </article> </main> <footer data-astro-cid-sz7xmlte>
&copy; 2025 Tal Naeh. All rights reserved.
<div class="social-links" data-astro-cid-sz7xmlte> <a href="https://linkedin.com/in/tal-naeh" target="_blank" data-astro-cid-sz7xmlte> <span class="sr-only" data-astro-cid-sz7xmlte>Follow on LinkedIn</span> <svg viewBox="0 0 16 16" aria-hidden="true" width="32" height="32" astro-icon="social/twitter" data-astro-cid-sz7xmlte><path fill="currentColor" d="M0 1.146C0 .513.526 0 1.175 0h13.65C15.474 0 16 .513 16 1.146v13.708c0 .633-.526 1.146-1.175 1.146H1.175C.526 16 0 15.487 0 14.854V1.146zm4.943 12.248V6.169H2.542v7.225h2.401zm-1.2-8.212c.837 0 1.358-.554 1.358-1.248-.015-.709-.52-1.248-1.342-1.248-.822 0-1.359.54-1.359 1.248 0 .694.521 1.248 1.327 1.248h.016zm4.908 8.212V9.359c0-.216.016-.432.08-.586.173-.431.568-.878 1.232-.878.869 0 1.216.662 1.216 1.634v3.865h2.401V9.25c0-2.22-1.184-3.252-2.764-3.252-1.274 0-1.845.7-2.165 1.193v.025h-.016a5.54 5.54 0 0 1 .016-.025V6.169h-2.4c.03.678 0 7.225 0 7.225h2.4z" data-astro-cid-sz7xmlte></path></svg> </a> <a href="https://github.com/Tal-Naeh" target="_blank" data-astro-cid-sz7xmlte> <span class="sr-only" data-astro-cid-sz7xmlte>Visit my GitHub</span> <svg viewBox="0 0 16 16" aria-hidden="true" width="32" height="32" astro-icon="social/github" data-astro-cid-sz7xmlte><path fill="currentColor" d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.012 8.012 0 0 0 16 8c0-4.42-3.58-8-8-8z" data-astro-cid-sz7xmlte></path></svg> </a> </div> </footer>  </body></html>